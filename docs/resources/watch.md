---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "xray_watch Resource - terraform-provider-xray"
subcategory: "Watch"
---

# xray_watch (Resource)

Provides an Xray Watch resource.

[Official documentation](https://www.jfrog.com/confluence/display/JFROG/Configuring+Xray+Watches#ConfiguringXrayWatches-CreatingaWatch).

[API documentation](https://www.jfrog.com/confluence/display/JFROG/Xray+REST+API#XrayRESTAPI-CreateWatch).


## Example Usage

```terraform
resource "xray_watch" "all-repos" {
  name        = "all-repos-watch"
  description = "Watch for all repositories, matching the filter"
  active      = true
  project_key = "testproj"

  watch_resource {
    type = "all-repos"

    filter {
      type  = "regex"
      value = ".*"
    }
  }

  assigned_policy {
    name = xray_security_policy.allowed_licenses.name
    type = "security"
  }

  assigned_policy {
    name = xray_license_policy.banned_licenses.name
    type = "license"
  }

  assigned_policy {
    name = xray_operational_risk_policy.op_risk.name
    type = "operational_risk"
  }

  watch_recipients = ["test@email.com", "test1@email.com"]
}

resource "xray_watch" "repository" {
  name        = "repository-watch"
  description = "Watch a single repo or a list of repositories"
  active      = true
  project_key = "testproj"

  watch_resource {
    type       = "repository"
    bin_mgr_id = "default"
    name       = "your-repository-name"
    repo_type  = "local"

    filter {
      type  = "regex"
      value = ".*"
    }
  }

  watch_resource {
    type       = "repository"
    bin_mgr_id = "default"
    name       = "your-other-repository-name"
    repo_type  = "remote"

    filter {
      type  = "regex"
      value = ".*"
    }

    filter {
      type  = "mime-type"
      value = "application/json"
    }
  }

  assigned_policy {
    name = xray_security_policy.min_severity.name
    type = "security"
  }

  assigned_policy {
    name = xray_license_policy.cvss_range.name
    type = "license"
  }

  assigned_policy {
    name = xray_operational_risk_policy.op_risk.name
    type = "operational_risk"
  }

  watch_recipients = ["test@email.com", "test1@email.com"]
}

resource "xray_watch" "repository-ant-filter" {
  name        = "repository-watch"
  description = "Watch a single repo or a list of repositories, using ant pattern"
  active      = true
  project_key = "testproj"

  watch_resource {
    type       = "repository"
    bin_mgr_id = "default"
    name       = "your-repository-name"
    repo_type  = "local"

    path_ant_filter {
      exclude_patterns = ["**/*.md"]
      include_patterns = ["**/*.js"]
    }
  }

  watch_resource {
    type       = "repository"
    bin_mgr_id = "default"
    name       = "your-repository-name1"
    repo_type  = "local"

    path_ant_filter {
      exclude_patterns = ["**/*.md"]
    }
  }

  assigned_policy {
    name = xray_security_policy.min_severity.name
    type = "security"
  }

  assigned_policy {
    name = xray_license_policy.cvss_range.name
    type = "license"
  }

  assigned_policy {
    name = xray_operational_risk_policy.op_risk.name
    type = "operational_risk"
  }

  watch_recipients = ["test@email.com", "test1@email.com"]
}

resource "xray_watch" "repository-kv-filter" {
  name        = "repository-watch"
  description = "Watch a single repo or a list of repositories, using property filter"
  active      = true
  project_key = "testproj"

  watch_resource {
    type       = "repository"
    bin_mgr_id = "default"
    name       = "your-repository-name1"
    repo_type  = "local"

    kv_filter {
      type  = "property"
      key   = "artifact-property-name"
      value = "artifact-property-value"
    }
  }

  assigned_policy {
    name = xray_security_policy.min_severity.name
    type = "security"
  }

  assigned_policy {
    name = xray_license_policy.cvss_range.name
    type = "license"
  }

  assigned_policy {
    name = xray_operational_risk_policy.op_risk.name
    type = "operational_risk"
  }

  watch_recipients = ["test@email.com", "test1@email.com"]
}

resource "xray_watch" "all-builds-with-filters" {
  name        = "build-watch"
  description = "Watch all builds with Ant patterns filter"
  active      = true
  project_key = "testproj"

  watch_resource {
    type       = "all-builds"
    bin_mgr_id = "default"

    ant_filter {
      exclude_patterns = ["a*", "b*"]
      include_patterns = ["ab*"]
    }
  }

  assigned_policy {
    name = xray_security_policy.min_severity.name
    type = "security"
  }

  assigned_policy {
    name = xray_license_policy.cvss_range.name
    type = "license"
  }

  assigned_policy {
    name = xray_operational_risk_policy.op_risk.name
    type = "operational_risk"
  }

  watch_recipients = ["test@email.com", "test1@email.com"]
}

resource "xray_watch" "build" {
  name        = "build-watch"
  description = "Watch a single build or a list of builds"
  active      = true
  project_key = "testproj"

  watch_resource {
    type       = "build"
    bin_mgr_id = "default"
    name       = "your-build-name"
  }

  watch_resource {
    type       = "build"
    bin_mgr_id = "default"
    name       = "your-other-build-name"
  }

  assigned_policy {
    name = xray_security_policy.min_severity.name
    type = "security"
  }

  assigned_policy {
    name = xray_license_policy.cvss_range.name
    type = "license"
  }

  assigned_policy {
    name = xray_operational_risk_policy.op_risk.name
    type = "operational_risk"
  }

  watch_recipients = ["test@email.com", "test1@email.com"]
}

resource "xray_watch" "all-projects" {
  name        = "projects-watch"
  description = "Watch all the projects"
  active      = true
  project_key = "testproj"

  watch_resource {
    type       = "all-projects"
    bin_mgr_id = "default"
  }

  assigned_policy {
    name = xray_security_policy.min_severity.name
    type = "security"
  }

  assigned_policy {
    name = xray_license_policy.cvss_range.name
    type = "license"
  }

  assigned_policy {
    name = xray_operational_risk_policy.op_risk.name
    type = "operational_risk"
  }

  watch_recipients = ["test@email.com", "test1@email.com"]
}

resource "xray_watch" "all-projects-with-filters" {
  name        = "projects-watch"
  description = "Watch all the projects with Ant patterns filter"
  active      = true
  project_key = "testproj"

  watch_resource {
    type       = "all-projects"
    bin_mgr_id = "default"

    ant_filter {
      exclude_patterns = ["a*", "b*"]
      include_patterns = ["ab*"]
    }
  }

  assigned_policy {
    name = xray_security_policy.min_severity.name
    type = "security"
  }

  assigned_policy {
    name = xray_license_policy.cvss_range.name
    type = "license"
  }

  assigned_policy {
    name = xray_operational_risk_policy.op_risk.name
    type = "operational_risk"
  }

  watch_recipients = ["test@email.com", "test1@email.com"]
}

resource "xray_watch" "project" {
  name        = "project-watch"
  description = "Watch selected projects"
  active      = true
  project_key = "testproj"

  watch_resource {
    type = "project"
    name = "test"
  }
  watch_resource {
    type = "project"
    name = "test1"
  }

  assigned_policy {
    name = xray_security_policy.min_severity.name
    type = "security"
  }

  assigned_policy {
    name = xray_license_policy.cvss_range.name
    type = "license"
  }

  assigned_policy {
    name = xray_operational_risk_policy.op_risk.name
    type = "operational_risk"
  }

  watch_recipients = ["test@email.com", "test1@email.com"]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `assigned_policy` (Block Set, Min: 1) Nested argument describing policies that will be applied. Defined below. (see [below for nested schema](#nestedblock--assigned_policy))
- `name` (String) Name of the watch (must be unique)
- `watch_resource` (Block Set, Min: 1) Nested argument describing the resources to be watched. Defined below. (see [below for nested schema](#nestedblock--watch_resource))

### Optional

- `active` (Boolean) Whether or not the watch is active
- `description` (String) Description of the watch
- `project_key` (String) Project key for assigning this resource to. Must be 2 - 10 lowercase alphanumeric and hyphen characters. Support repository and build watch resource types. When specifying individual repository or build they must be already assigned to the project. Build must be added as indexed resources.
- `watch_recipients` (Set of String) A list of email addressed that will get emailed when a violation is triggered.

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--assigned_policy"></a>
### Nested Schema for `assigned_policy`

Required:

- `name` (String) The name of the policy that will be applied
- `type` (String) The type of the policy - security, license or operational risk


<a id="nestedblock--watch_resource"></a>
### Nested Schema for `watch_resource`

Required:

- `type` (String) Type of resource to be watched. Options: repository, all-repos, build, all-builds, project, all-projects, releaseBundle, all-releaseBundles, releaseBundleV2, all-releaseBundlesV2.

Optional:

- `ant_filter` (Block Set) `ant-patterns` filter for `all-builds` and `all-projects` watch_resource.type (see [below for nested schema](#nestedblock--watch_resource--ant_filter))
- `bin_mgr_id` (String) The ID number of a binary manager resource. Default value is `default`. To check the list of available binary managers, use the API call `${JFROG_URL}/xray/api/v1/binMgr` as an admin user, use `binMgrId` value. More info [here](https://www.jfrog.com/confluence/display/JFROG/Xray+REST+API#XrayRESTAPI-GetBinaryManager)
- `filter` (Block Set) Filter for `regex`, `package-type` and `mime-type` type. Works for `repository` and `all-repos` watch_resource.type (see [below for nested schema](#nestedblock--watch_resource--filter))
- `kv_filter` (Block Set) Filter for `property` type. Works for `repository` and `all-repos` watch_resource.type. (see [below for nested schema](#nestedblock--watch_resource--kv_filter))
- `name` (String) The name of the build, repository, project, or release bundle. Xray indexing must be enabled on the repository, build, or release bundle.
- `path_ant_filter` (Block Set) `path-ant-patterns` filter for `repository` and `all-repos` watch_resource.type (see [below for nested schema](#nestedblock--watch_resource--path_ant_filter))
- `repo_type` (String) Type of repository. Only applicable when `type` is `repository`. Options: `local` or `remote`.

<a id="nestedblock--watch_resource--ant_filter"></a>
### Nested Schema for `watch_resource.ant_filter`

Optional:

- `exclude_patterns` (List of String) Use Ant-style wildcard patterns to specify build names (i.e. artifact paths) in the build info repository (without a leading slash) that will be excluded in this watch. Projects are supported too. Ant-style path expressions are supported (*, **, ?). For example, an 'apache/**' pattern will exclude the 'apache' build info in the watch.
- `include_patterns` (List of String) Use Ant-style wildcard patterns to specify build names (i.e. artifact paths) in the build info repository (without a leading slash) that will be included in this watch. Projects are supported too. Ant-style path expressions are supported (*, **, ?). For example, an 'apache/**' pattern will include the 'apache' build info in the watch.


<a id="nestedblock--watch_resource--filter"></a>
### Nested Schema for `watch_resource.filter`

Required:

- `type` (String) The type of filter, such as `regex`, `path-regex`, `package-type`, or `mime-type`
- `value` (String) The value of the filter, such as the text of the regex, name of the package type, or mime type.


<a id="nestedblock--watch_resource--kv_filter"></a>
### Nested Schema for `watch_resource.kv_filter`

Required:

- `key` (String) The value of the filter, such as the property name of the artifact.
- `type` (String) The type of filter. Currently only support `property`
- `value` (String) The value of the filter, such as the property value of the artifact.


<a id="nestedblock--watch_resource--path_ant_filter"></a>
### Nested Schema for `watch_resource.path_ant_filter`

Optional:

- `exclude_patterns` (List of String) The pattern will apply to the selected repositories. Simple comma separated wildcard patterns for repository artifact paths (with no leading slash). Ant-style path expressions are supported (*, **, ?). For example: 'org/apache/**'
- `include_patterns` (List of String) The pattern will apply to the selected repositories. Simple comma separated wildcard patterns for repository artifact paths (with no leading slash). Ant-style path expressions are supported (*, **, ?). For example: 'org/apache/**'

## Import

Import is supported using the following syntax:

```sh
terraform import xray_watch.my-watch watch-name
```

### Import with `project_key`

To import watch that is in the scope of a project, you'll need to include the project key as part of the resource ID, separated by a colon (`:`).

For instance, using the following config during import:
```terraform
resource "xray_watch" "my-watch" {
  name        = "watch-name"
  project_key = "my-project"
}
```

Then use `terraform xray_watch.my-watch watch-name:my-project` to import the watch `watch-name` in the scope of project `my-project`.
